<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<link href="./assets/img/apple-icon.png" rel="apple-touch-icon" sizes="76x76">
	<link href="./assets/img/favicon.png" rel="icon" type="image/png">
	<meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
	<title>Junge Liberale | Content Generator</title>
	<meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, shrink-to-fit=no' name='viewport'><!--     Fonts and icons     -->
	<link href="https://fonts.googleapis.com/css?family=Montserrat:400,700,200" rel="stylesheet">
	<link href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css" rel="stylesheet"><!-- CSS Files -->
	<link href="./assets/css/bootstrap.min.css" rel="stylesheet">
	<link href="./assets/css/now-ui-kit.css?v=1.1.0" rel="stylesheet"><!-- CSS Just for demo purpose, don't include it in your project -->
	<link href="./assets/css/demo.css" rel="stylesheet">
	<style>
	     @font-face {
	       font-family: "Montserrat-Regular";
	       src: url("./assets/fonts/Montserrat-Regular.otf");
	     }
	     
	     
	     .mag-text {
	       font-family: "Montserrat-Regular", Arial, sans-serif;
	       color: #e5007d;
	     }
	     
	     .blue-button{
	       background-color: #009ee3;
	     }
	     
	     .blue-button:hover{
	       background-color: #009ea3;
	     }
	     
	     .attention{
	       border: 2px solid #ff9900;
	     }
	     .attention:hover{
	       border: 2px solid #009ee3;
	     }
	     
	     .testimonial-group > .row {
	       overflow-x: auto;
	       white-space: nowrap;
	     }
	     .testimonial-group > .row > .col-xs-4 {
	       display: inline-block;
	       float: none;
	     }
	     
	</style>
</head>
<body style="background-color: #ffed00;">
	<div class="page-header" id="init">
		<div class="container">
			<div class="col-md-4 content-center">
				<div class="card card-login card-plain">
					<form action="" class="form" method="">
						<div class="header header-primary text-center"><img alt="" class="img-fluid" src="./assets/img/Logo-Junge-Liberale-web.png"></div><br>
						<div class="content">
							<h5 class="mag-text"><b>Content Generator</b></h5>
							<p class="mag-text"><b>Please press "Get Started" button to start creating.</b></p>
						</div>
						<div class="footer text-center" id="hide-btn">
							<a class="btn btn-info btn-lg"><b>Get Started</b></a>
						</div>
					</form>
				</div>
			</div>
		</div>
	</div>
	<div id="editor" style="display: none;">
		<img alt="" class="img-fluid" src="./assets/img/Logo-Junge-Liberale-web.png" style="height: 10vh">
		<canvas id="visible"></canvas>
		<div class="container">
			<div class="row">
				<div class="text-center">
					<button class="btn btn-sm btn-info float-right" id="upload" type="button"><i class="fa fa-upload"></i> Upload</button> <input class="form-control" id="imgLoader" placeholder="Default" style="display: none" type="file">
				</div>
			</div>
		</div><br>
		<div class="container testimonial-group">
			<div class="row">
				<div class="col-12 mag-text">
					Add Frame
				</div>
			</div>
			<div class="row">
				<div class="frame-div col-md-3 col-sm-4 col-xs-6 attention"><img alt="" class="img-fluid" src="./assets/img/Vorlage%20Rahmen.png"></div>
			</div>
		</div><br>
		<div class="container">
			<div class="row">
				<div class="col-12 mag-text">
					Add Banner
				</div>
			</div>
			<div class="row">
				<div class="banner-div col-md-3 col-sm-4 col-xs-6 attention" style="background-color: white"><img alt="" class="img-fluid" src="./assets/img/Text%20Balken%20Hintergrund%204.png"></div>
				<div class="banner-div col-md-3 col-sm-4 col-xs-6 attention"><img alt="" class="img-fluid" src="./assets/img/Text%20Balken%20Hintergrund.png"></div>
			</div>
		</div><br>
		<div class="container">
			<div class="row">
				<div class="col mag-text">
					Add Text
				</div>
			</div>
			<div class="row" style="padding: 30px">
				<div>
					Please choose color <input type="color" value="#ffffff">
				</div>
			</div><br>
			<div class="row" style="padding: 10px">
				<input class="form-control" placeholder="" style="border: 0px solid white; border-radius: 0px; border-bottom: 2px solid #009ee3" type="text"> <button class="btn btn-info" id="slogan-add">Add</button>
			</div>
		</div><br>
		<div class="container">
			<div class="row">
				<div class="col-12 text-center">
					<button class="btn btn-info" id="download-button">Download Image</button>
				</div>
			</div>
		</div>
	</div><!--   Core JS Files   -->
	<script src="./assets/js/core/jquery.3.2.1.min.js" type="text/javascript">
	</script> 
	<script src="./assets/js/core/popper.min.js" type="text/javascript">
	</script> 
	<script src="./assets/js/core/bootstrap.min.js" type="text/javascript">
	</script> <!--  Plugin for Switches, full documentation here: http://www.jque.re/plugins/version3/bootstrap.switch/ -->
	<script src="./assets/js/plugins/bootstrap-switch.js">
	</script> <!--  Plugin for the Sliders, full documentation here: http://refreshless.com/nouislider/ -->
	<script src="./assets/js/plugins/nouislider.min.js" type="text/javascript">
	</script> <!--  Plugin for the DatePicker, full documentation here: https://github.com/uxsolutions/bootstrap-datepicker -->
	<script src="./assets/js/plugins/bootstrap-datepicker.js" type="text/javascript">
	</script> <!-- Control Center for Now Ui Kit: parallax effects, scripts for the example pages etc -->
	<script src="./assets/js/now-ui-kit.js?v=1.1.0" type="text/javascript">
	</script> <!--  Fabric Js -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/1.7.20/fabric.min.js" type="text/javascript">
	</script> 
	<script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/1.3.3/FileSaver.min.js">
	</script> 
	<script>
	 $('#hide-btn').on('click', function(){
	   $('#init').fadeOut('slow');
	   $('#editor').show('slow');
	 });
	 
	 var back_image_src = "./assets/img/nophoto.jpg", frame_src = null, banner_src = null, slogan_text = null, text_color = '#ffffff';
	 var canvas = new fabric.Canvas('visible',  { width: window.innerWidth, preserveObjectStacking: true });
	   
	 function render(cur_canvas){
	     canvas.clear();
	     var back_image = new Image();
	       back_image.src = back_image_src;
	       back_image.onload = function(){
	         var background = new fabric.Image(back_image);
	         background.set({
	           height : canvas.height,
	           width : canvas.width,
	           top : 0,
	           left : 0,
	           lockMovementX : true,
	           lockMovementY : true,
	           lockScalingX : true,
	           lockScalingY : true,
	           lockMovementX : true,
	           lockRotation : true,
	         });
	         canvas.add(background);
	         canvas.bringToFront(background);
	   
             if(frame_src != null){
               var fr_image = new Image();
               fr_image.src = frame_src;
               fr_image.onload = function(){
                 var frame = new fabric.Image(fr_image);
                 frame.set({
                   height : canvas.height,
                   width : canvas.width,
                   top : 0,
                   left : 0,
                   lockMovementX : true,
                   lockMovementY : true,
                   lockScalingX : true,
                   lockScalingY : true,
                   lockMovementX : true,
                   lockRotation : true,
                 });
                 canvas.add(frame);
                 canvas.bringToFront(frame);
                 if(banner_src != null){
                   var bn_image = new Image();
                   bn_image.src = banner_src;
                   bn_image.onload = function(){
                     var banner = new fabric.Image(bn_image);
                     var scale_banner = (canvas.width - 200) / bn_image.width;
                     banner.set({
                       height : bn_image.height * scale_banner,
                       width : bn_image.width * scale_banner,
                       top : 100,
                       left : 100,
                     });
                     canvas.add(banner);
                     canvas.bringToFront(banner);
                     if(slogan_text != null){
                       var text = new fabric.Text(slogan_text, { left: 120, top: 120, fill: text_color});
                       canvas.add(text); 
                       canvas.bringToFront(text);
                     }
                   }
                 }
               }
             }
             else if(banner_src != null){
                 var bn_image = new Image();
                 bn_image.src = banner_src;
                 bn_image.onload = function(){
                   var banner = new fabric.Image(bn_image);
                   var scale_banner = (canvas.width - 200) / bn_image.width;
                   banner.set({
                     height : bn_image.height * scale_banner,
                     width : bn_image.width * scale_banner,
                     top : 100,
                     left : 100,
                   });
                   canvas.add(banner);
                   canvas.bringToFront(banner);
                   if(slogan_text != null){
                     var text = new fabric.Text(slogan_text, { left: 120, top: 120, fill: text_color});
                     canvas.add(text); 
                     canvas.bringToFront(text);
                   }
                 }
               }
             else if(slogan_text != null){
                 var text = new fabric.Text(slogan_text, { left: 120, top: 120, fill: text_color});
                 canvas.add(text); 
                 canvas.bringToFront(text);
               }
           }
      }

	   $(function(){
	     render(canvas);
	     setTimeout(function(){ render(canvas); }, 500);
	     setTimeout(function(){ render(canvas); }, 500)
	   })
	 
	   document.getElementById('imgLoader').onchange = function handleImage(e) {
	     var reader = new FileReader();
	     reader.onload = function (event) {
	         back_img_src = event.target.result;
	         render(canvas);
	         setTimeout(function(){ 
	           render(canvas); 
	         }, 500);
	         setTimeout(function(){ 
	           render(canvas); 
	         }, 500)
	     }
	     reader.readAsDataURL(e.target.files[0]);
	   };

	   $(window).on('resize', function(){
	     render(canvas);
	   });

	   $('#upload').on('click', function(){
	     $('#imgLoader').click();
	   });
	 
	   $('.frame-div').on('click', function(){
	     frame_src = $(this).find('img').attr('src');
	     render(canvas);
	   });
	 
	   $('.banner-div').on('click', function(){
	     banner_src = $(this).find('img').attr('src');
	     render(canvas);
	   });
	 
	   $('input[type="color"]').on('change', function(){
	     text_color = $(this).val();
	   });
	 
	   $('#slogan-add').on('click', function(){
	     var inp =$(this).parent().find('input');
	     slogan_text = inp.val();
	     inp.val('');
	     render(canvas);
	   });
	   
	   $("#download-button").on('click', function(){
         canvas.deactivateAll().renderAll();
	     $("#visible").get(0).toBlob(function(blob){
	         saveAs(blob, "image" + new Date().getTime() + ".png");
	     });
	   });
	 
	</script> 
</body>
</html>